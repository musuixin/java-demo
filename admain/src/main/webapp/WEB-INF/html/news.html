<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <link rel="icon" type="image/png" sizes="16x16" href="/admain_war_exploded/assets/images/favicon.png">
    <title>富文本编辑器</title>

    <link href="/admain_war_exploded/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <link href="/admain_war_exploded/css/style.css" rel="stylesheet">

    <link href="/admain_war_exploded/css/colors/red.css" id="theme" rel="stylesheet">


    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>

    <![endif]-->
</head>

<body class="fix-header card-no-border" id="myModal">

<!-- Preloader - style you can find in spinners.css -->

<div class="preloader">
    <svg class="circular" viewBox="25 25 50 50">
        <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/>
    </svg>
</div>

<!-- Main wrapper - style you can find in pages.scss -->

<div id="main-wrapper">

    <!-- Topbar header - style you can find in pages.scss -->

    <header class="topbar">
        <nav class="navbar top-navbar navbar-toggleable-sm navbar-light">


            <div class="navbar-header">
                <a class="navbar-brand" href="admaininfo.html">

                    <b>
                        <!--You can put here icon as well // <i class="wi wi-sunset"></i> //-->

                        <img src="/admain_war_exploded/assets/images/logo-icon.png" alt="homepage" class="dark-logo"/>

                    </b>


                    <span>
                         
                         <img src="/admain_war_exploded/assets/images/logo-text.JPG" alt="homepage" class="dark-logo"/>
                         </span> </a>
            </div>


            <div class="navbar-collapse">


                <ul class="navbar-nav mr-auto mt-md-0 ">

                    <li class="nav-item"><a class="nav-link nav-toggler hidden-md-up text-muted waves-effect waves-dark"
                                            href="javascript:void(0)"><i class="ti-menu"></i></a></li>
                    <li class="nav-item hidden-sm-down">
                        <form class="app-search p-l-20">
                            <input type="text" class="form-control" placeholder="搜索功能制作中"> <a class="srh-btn"><i
                                class="ti-search"></i></a>
                        </form>
                    </li>
                </ul>


                <ul class="navbar-nav my-lg-0">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-muted waves-effect waves-dark" href=""
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><img
                                src="/admain_war_exploded/assets/images/users/sanjiu.JPG" alt="user"
                                class="profile-pic m-r-5"/>慕随心</a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>
    <aside class="left-sidebar">

        <div class="scroll-sidebar">

            <nav class="sidebar-nav">
                <ul id="sidebarnav">
                    <li>
                        <a href="/admain_war_exploded/admain/admaininfo" class="waves-effect"><i
                                class="fa fa-user m-r-10"
                                aria-hidden="true"></i>管理员</a>
                    </li>
                    <li>
                        <a href="/admain_war_exploded/admain/table-basic" class="waves-effect"><i
                                class="fa fa-table m-r-10"
                                aria-hidden="true"></i>招聘表信息</a>
                    </li>
                    <li>
                        <a href="/admain_war_exploded/admain/news" class="waves-effect"><i
                                class="fa fa-columns m-r-10"
                                aria-hidden="true"></i>新闻编辑器</a>
                    </li>
                    <li>
                        <a href="/admain_war_exploded/admain/news-table" class="waves-effect"><i
                                class="fa fa-columns m-r-10"
                                aria-hidden="true"></i>新闻列表</a>
                    </li>
                </ul>
                <div class="text-center m-t-30">
                    <a href="http://www.musuixin.top/" class="btn btn-danger">返回主页</a>
                </div>
            </nav>

        </div>

    </aside>

    <!-- End Left Sidebar - style you can find in sidebar.scss  -->


    <div class="page-wrapper">


        <div class="container-fluid">


            <div class="row page-titles">
                <div class="col-md-6 col-8 align-self-center">
                    <h3 class="text-themecolor m-b-0 m-t-0">添加新闻</h3>
                </div>
            </div>


            <div class="row">
                <div class="col-6">
                    <div class="card">
                        <div class="card-block text-center">
                            <h2 class="text-blue  text-active">新闻内容</h2>
                            <script id="editor" class=".col-md-offset-4" type="text/plain"></script>

                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="card">
                        <div class="card-block">
                            <h2 class="text-blue text-center">新闻信息</h2>
                            <form action="" nctype="multipart/form-data" onsubmit="return false">
                                <div class="form-group">
                                    <label for="">新闻标题</label>
                                    <input type="text" name="title" class="form-control" placeholder=""
                                           aria-describedby="helpId" required>
                                </div>
                                <div class="form-group">
                                    <label for="">新闻封面</label>
                                    <input type="file" id="input-id" name="frontCover" required>
                                </div>
                                <div class="form-group">
                                    <label for="">新闻作者</label>
                                    <input type="text" name="author" id="" class="form-control" placeholder=""
                                           aria-describedby="helpId" required>
                                </div>
                                <div class="form-group">
                                    <label for="">新闻板块</label>
                                    <select class="form-control" name="plate" id="">
                                        <option>科技</option>
                                        <option>美文</option>
                                        <option>时政</option>
                                        <option>旅行</option>
                                        <option>动漫</option>
                                        <option>编程</option>
                                        <option>感悟</option>
                                    </select>
                                </div>
                                <div style="margin-top: 20px">
                                    <button class="btn btn-primary" id="submit">提交
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>


        </div>


        <footer class="footer text-center">
            © 2019 慕随心管理系统后台
        </footer>


    </div>


</div>


<script src="/admain_war_exploded/assets/plugins/jquery/jquery.min.js"></script>

<script src="/admain_war_exploded/assets/plugins/bootstrap/js/tether.min.js"></script>
<script src="/admain_war_exploded/assets/plugins/bootstrap/js/bootstrap.min.js"></script>

<script src="/admain_war_exploded/js/jquery.slimscroll.js"></script>

<script src="/admain_war_exploded/js/waves.js"></script>

<script src="/admain_war_exploded/js/sidebarmenu.js"></script>

<script src="/admain_war_exploded/assets/plugins/sticky-kit-master/dist/sticky-kit.min.js"></script>

<script src="/admain_war_exploded/js/custom.min.js"></script>


<script src="/admain_war_exploded/assets/plugins/styleswitcher/jQuery.style.switcher.js"></script>
<script src="/admain_war_exploded/libs/ueditor.config.js"></script>
<script src="/admain_war_exploded/libs/ueditor.all.min.js"></script>
<script src="/admain_war_exploded/libs/lang/zh-cn/zh-cn.js"></script>
<link href="https://cdn.bootcss.com/bootstrap-fileinput/5.0.1/css/fileinput.min.css" rel="stylesheet">
<script src="https://cdn.bootcss.com/bootstrap-fileinput/5.0.1/js/fileinput.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap-fileinput/4.4.8/js/locales/zh.js"></script>
<script>

    $(function () {
        function hideModal() {
            $('#myModal').modal('hide');
        };

        function showModal() {
            $('#myModal').modal({backdrop: 'static', keyboard: false});
        };
        //实例化编辑器
        var ue = UE.getEditor('editor', {
            initialFrameWidth: "100%",   //初始化宽度
            initialFrameHeight: 600,     //初始化高度
        });
        $(function () {
            $("#input-id").fileinput({
                dropZoneEnabled: false,
                showUpload: false,
                'previewFileType': 'any',
                language: 'zh',
                allowedFileExtensions: ['jpg', 'png', 'bmp', 'jpeg']
            });

        });
        $("form").submit(function () {
            //获取ueditor编辑框中的html文本内容
            var formData = new FormData();
            var content = UE.getEditor('editor').getContent();

            var fileObj = $("input[name = 'frontCover']")[0].files[0]; //获得文件上传的输入框的文件流
            formData.append('img', fileObj);
            formData.append('title', $("input[name = 'title']").val());
            formData.append('author', $("input[name = 'author']").val());
            formData.append('plate', $("select[name = 'plate']").val());
            formData.append('text', content);
            $.ajax({
                url: '/admain_war_exploded/news',
                type: 'POST',
                processData: false,//tell jQuery not to process the data
                contentType: false,//tell jQuery not to set contentType
                beforeSend: function () {
                    showModal();
                },
                data: formData,
                success: function (res) {
                    alert("发布成功！");
                    location.reload();
                },
                error: function () {
                    alert("发布失败！");
                    hideModal();
                }
            })
        })
    })

</script>

</body>

</html>
